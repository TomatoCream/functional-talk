<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Functional Programming: Real World Performance, Nix and Warp Server</title>
<meta name="author" content="Wong Ding Feng"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/css/reveal.css"/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/css/theme/moon.css" id="theme"/>


<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdn.jsdelivr.net/npm/reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide">
<h1 class="title">Functional Programming: Real World Performance, Nix and Warp Server</h1><h2 class="author">Wong Ding Feng</h2><p class="date">Created: 2019-07-29 Mon 11:59</p>
</section>
<section id="table-of-contents-section">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#/slide-org9218a0a">1. Who am I? Introduction to myself</a>
<ul>
<li><a href="#/slide-orgf5eafab">1.1. My interests</a></li>
<li><a href="#/slide-org62b7192">1.2. For whom is this talk for?</a></li>
</ul>
</li>
<li><a href="#/slide-org0e39db2">2. The big problem</a>
<ul>
<li><a href="#/slide-org264d103">2.1. Some modern day package management systems</a></li>
<li><a href="#/slide-org91f9c2a">2.2. What about sub ecosystems?</a></li>
<li><a href="#/slide-org5d3b655">2.3. How to make a package manager?</a></li>
<li><a href="#/slide-orgb7e0f96">2.4. How to make a package manager?</a></li>
<li><a href="#/slide-org5f3d8af">2.5. Problems with modern package management</a></li>
<li><a href="#/slide-orga2b062b">2.6. <span class="todo TODO">TODO</span> Why imperative is bad? What is so imperative about installing packages?</a></li>
<li><a href="#/slide-orgb041ae0">2.7. Are you familiar with <code>DEPENDENCY HELL</code>?</a></li>
<li><a href="#/slide-org7b6b706">2.8. All types of "HELL"</a></li>
<li><a href="#/slide-org0fe60dd">2.9. Not Atomic</a></li>
<li><a href="#/slide-orgede0c84">2.10. Whats bad about imperative summary?</a></li>
</ul>
</li>
<li><a href="#/slide-org1b26aac">3. What it should/could/would have been?</a>
<ul>
<li><a href="#/slide-org5163bb9">3.1. Introducing NixOS</a></li>
<li><a href="#/slide-org96bf7b7">3.2. demo 1</a></li>
<li><a href="#/slide-org4653319">3.3. Extra goodies!</a></li>
<li><a href="#/slide-orgb7bdc18">3.4. Going all the way</a></li>
<li><a href="#/slide-orgbf9563e">3.5. There are actually 2 players</a></li>
</ul>
</li>
</ul>
</div>
</div>
</section>
<section>
<section id="slide-org9218a0a">
<h2 id="org9218a0a"><span class="section-number-2">1</span> Who am I? Introduction to myself</h2>
<ul>
<li>Follow me on github!
<a href="https://github.com/TomatoCream">https://github.com/TomatoCream</a></li>
<li>Linux user for 5 years now
<ul>
<li>Ubuntu</li>
<li>Proxmox</li>
<li>ArchLinux</li>
<li>Centos (server management)</li>

</ul></li>

</ul>
</section>
<section id="slide-orgf5eafab">
<h3 id="orgf5eafab"><span class="section-number-3">1.1</span> My interests</h3>
<ul>
<li>AI, ML</li>
<li>Functional programming and abstraction (what the hell is so good about this?)</li>
<li>Philosophy
<ul>
<li>occam's razor
&lt;peekture&gt;</li>

</ul></li>

</ul>
</section>
<section id="slide-org62b7192">
<h3 id="org62b7192"><span class="section-number-3">1.2</span> For whom is this talk for?</h3>
<ul>
<li>Linux users! Sorry windows users
<ul>
<li>But not really (departs away from a unix way of doing things)</li>

</ul></li>
<li>Show you what functional programming can do?
<ul>
<li>purity?</li>
<li>referential transparency?</li>

</ul></li>
<li>State management</li>
<li>DevOps</li>
<li>Images, Docker, VM, Clusters</li>

</ul>
</section>
</section>
<section>
<section id="slide-org0e39db2">
<h2 id="org0e39db2"><span class="section-number-2">2</span> The big problem</h2>
<ul>
<li>Has anyone ever used some sort of package management system?</li>

</ul>
</section>
<section id="slide-org264d103">
<h3 id="org264d103"><span class="section-number-3">2.1</span> Some modern day package management systems</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Package manager</th>
<th scope="col" class="org-left">Distributions</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">apt, apt-get</td>
<td class="org-left">Debian, Ubuntu</td>
</tr>

<tr>
<td class="org-left">rpm, yum</td>
<td class="org-left">Redhat, Centos</td>
</tr>

<tr>
<td class="org-left">pacman</td>
<td class="org-left">ArchLinux</td>
</tr>

<tr>
<td class="org-left">brew</td>
<td class="org-left">MacOS</td>
</tr>
</tbody>
</table>
</section>
<section id="slide-org91f9c2a">
<h3 id="org91f9c2a"><span class="section-number-3">2.2</span> What about sub ecosystems?</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Package manager</th>
<th scope="col" class="org-left">???</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">pip, virtualenv, pipenv</td>
<td class="org-left">Python2,3(???)</td>
</tr>

<tr>
<td class="org-left">npm, yarn</td>
<td class="org-left">Nodejs</td>
</tr>

<tr>
<td class="org-left">cabal, stack, hackage</td>
<td class="org-left">Haskell :)</td>
</tr>

<tr>
<td class="org-left">go?</td>
<td class="org-left">go?</td>
</tr>

<tr>
<td class="org-left">brew</td>
<td class="org-left">MacOS</td>
</tr>

<tr>
<td class="org-left">use-package, vim, fish, zsh</td>
<td class="org-left">&#x2026;</td>
</tr>
</tbody>
</table>
</section>
<section id="slide-org5d3b655">
<h3 id="org5d3b655"><span class="section-number-3">2.3</span> How to make a package manager?</h3>
<ul>
<li>What are the basic parts that we need?</li>

</ul>
</section>
<section id="slide-orgb7e0f96">
<h3 id="orgb7e0f96"><span class="section-number-3">2.4</span> How to make a package manager?</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">build dependencies</td>
<td class="org-left">What do I need to build the program?</td>
</tr>

<tr>
<td class="org-left">runtime dependencies</td>
<td class="org-left">What <code>.so</code> shared objects do I need?</td>
</tr>

<tr>
<td class="org-left">configurations</td>
<td class="org-left">What in <code>/etc/...</code> config files</td>
</tr>
</tbody>
</table>
<ul>
<li>essentially think of it as a graph, whenever we upgrade or install a package,
we are mutating a node on this graph to point to something else.</li>

</ul>
</section>
<section id="slide-org5f3d8af">
<h3 id="org5f3d8af"><span class="section-number-3">2.5</span> Problems with modern package management</h3>
<p>
<a href="https://wiki.debian.org/DontBreakDebian#Don.27t_make_a_FrankenDebian">https://wiki.debian.org/DontBreakDebian#Don.27t_make_a_FrankenDebian</a>
<img src="./images/screenshot-01.png" alt="screenshot-01.png" />
</p>
</section>
<section id="slide-orga2b062b">
<h3 id="orga2b062b"><span class="section-number-3">2.6</span> <span class="todo TODO">TODO</span> Why imperative is bad? What is so imperative about installing packages?</h3>
<p>
referential transparency
</p>
</section>
<section id="slide-orgb041ae0">
<h3 id="orgb041ae0"><span class="section-number-3">2.7</span> Are you familiar with <code>DEPENDENCY HELL</code>?</h3>
<ul>
<li><a href="https://www.reddit.com/r/ProgrammerHumor/comments/75txp4/nodejs_dependency_hell_visualized_for_the_first/?utm_source=share&amp;utm_medium=web2x">https://www.reddit.com/r/ProgrammerHumor/comments/75txp4/nodejs_dependency_hell_visualized_for_the_first/?utm_source=share&amp;utm_medium=web2x</a></li>
<li><a href="https://github.com/vector-im/riot-web/network/dependencies">https://github.com/vector-im/riot-web/network/dependencies</a></li>

</ul>
</section>
<section id="slide-org7b6b706">
<h3 id="org7b6b706"><span class="section-number-3">2.8</span> All types of "HELL"</h3>

<div class="figure">
<p><img src="https://miro.medium.com/max/984/0*7ezJOtYUkI5zyqWU.png" alt="0*7ezJOtYUkI5zyqWU.png" />
</p>
</div>
<ul>
<li>{ DLL, dependency, npm, cabal } hell, different names for the same demon</li>
<li>shared components like library links <code>cuda.7.so</code> vs <code>cuda.6.so</code></li>
<li>multiple version side by side and roll backs</li>

</ul>
</section>
<section id="slide-org0fe60dd">
<h3 id="org0fe60dd"><span class="section-number-3">2.9</span> Not Atomic</h3>
<ul>
<li>kill upgrades half way</li>

</ul>
<div class="org-src-container">

<pre  class="src src-sh">COMMAND   PID USER   FD   TYPE DEVICE SIZE/OFF   NODE NAME
dpkg    29329 root    3uW  REG    8,7        0 262367 /var/lib/dpkg/lock
</pre>
</div>
<ul>
<li>Solution? Reformat!</li>

</ul>
</section>
<section id="slide-orgede0c84">
<h3 id="orgede0c84"><span class="section-number-3">2.10</span> Whats bad about imperative summary?</h3>
<ul>
<li>No referential transparency
<ul>
<li>cannot point to older versions of the same thing</li>

</ul></li>
<li>Dependency hell</li>
<li>Not atomic upgrades
<ul>
<li>unknown state if break half way</li>

</ul></li>

</ul>
<p>
These problems are really similar to the problems with imperative languages!
like <code>JAVA</code> and people have already made solutions for them like how <code>Haskell</code>
does. We could learn a thing or two from them.
</p>
</section>
</section>
<section>
<section id="slide-org1b26aac">
<h2 id="org1b26aac"><span class="section-number-2">3</span> What it should/could/would have been?</h2>
<ul>
<li>Imagine now that we implemented all the things of a functional programming
language to create a functional package management system?</li>
<li>What can we achieve?</li>
<li>What can we do with this?</li>

</ul>
</section>
<section id="slide-org5163bb9">
<h3 id="org5163bb9"><span class="section-number-3">3.1</span> Introducing NixOS</h3>
<ul>
<li>No referential transparency
<ul>
<li>cannot point to older versions of the same thing</li>

</ul></li>
<li>Dependency hell</li>
<li>Not atomic upgrades
<ul>
<li>unknown state if break half way</li>

</ul></li>

</ul>
</section>
<section id="slide-org96bf7b7">
<h3 id="org96bf7b7"><span class="section-number-3">3.2</span> demo 1</h3>
</section>
<section id="slide-org4653319">
<h3 id="org4653319"><span class="section-number-3">3.3</span> Extra goodies!</h3>
<ul>
<li>same <b>development</b> environment as the <b>runtime</b> environment!</li>
<li></li>

<li>show that 2 different version can run at the same time</li>
<li>nix-shell</li>
<li>easy revert
<ul>
<li>show OS reboot.</li>

</ul></li>

</ul>
</section>
<section id="slide-orgb7bdc18">
<h3 id="orgb7bdc18"><span class="section-number-3">3.4</span> Going all the way</h3>
<ul>
<li>What happens if you go all the way?</li>

</ul>
</section>
<section id="slide-orgbf9563e">
<h3 id="orgbf9563e"><span class="section-number-3">3.5</span> There are actually 2 players</h3>
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/lib/js/head.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/js/reveal.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: false,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: false,
pdfSeparateFragments: true,

overview: true,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none
transitionSpeed: 'default',
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]
});
</script>
</body>
</html>
